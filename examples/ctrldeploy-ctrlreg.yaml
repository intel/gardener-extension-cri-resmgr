# This file is generated by hacks/generate-controller-registration.sh - Do not commit, but change generation script!
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerDeployment
metadata:
  name: cri-resmgr-extension
type: helm
providerConfig:
  chart: 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

  values:
    ### For development purposes - set it to 0 (if you want to register extension but use local process with "make start").
    # replicaCount: 1            

    ### Uncomment this is you want to overwrite extension image or internal installation and agent images.
    ### Remember to build and push image  "make REGISTRY=v2.isvimgreg.com TAG=mybranch build-images push-images"
    ### "image" overwrites extension (for seed) and "images" overwrite installation/agent (for shoot) images defined in charts/images.yaml
    #image:
    #  repository: v2.isvimgreg.com/gardener-extension-cri-resmgr
    #  tag: mybranch
    #  pullPolicy: Always
    #imageVectorOverwrite: |
    #  images:
    #  - name: gardener-extension-cri-resmgr-installation
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-installation
    #  - name: gardener-extension-cri-resmgr-agent
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-agent
    ### Uncomment to provide own "fallback" configuration for CRI-Resource-Manager
    ### Use ballons policy as an example:
    # based on: https://github.com/intel/cri-resource-manager/blob/master/sample-configs/balloons-policy.cfg
    configs:
      ### Those options are passed directly to cri-resmgr binary.
      EXTRA_OPTIONS: | 
        EXTRA_OPTIONS="--metrics-interval 10s" 
      ### This is *static* initial configuraiton file that will be passed do systemd unit
      fallback: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-1000
          ReservedResources:
            CPU: 1
          balloons:
            PinCPU: true
            PinMemory: true
            BalloonTypes:
              - Name: "smallBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
        logger:
          Debug: resource-manager,cache,policy,resource-control,config-server,cpuallocator
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
      ### This is *dynamic* config that will be applied by cri-resmgr-agent
      default: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-1000
          ReservedResources:
            CPU: cpuset:1
          balloons:
            BalloonTypes:
              - Name: "smallHPBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
              - Name: "mediumLPBalloon"
                MinCPUs: 4
                MaxCPUs: 4
                MinBalloons: 1
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        # For furhter debugging
        # dump:
        #   Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerRegistration
metadata:
  name: cri-resmgr-extension
spec:
  deployment:
    # For development purpose - deploy the extensions before even shoots are created (or enabled)
    #policy: Always
    deploymentRefs:
    - name: cri-resmgr-extension
  resources:
  - kind: Extension
    type: cri-resmgr-extension
    globallyEnabled: false
    reconcileTimeout: "120s"
