# This file is generated by hacks/generate-controller-registration.sh - Do not commit, but change generation script!
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerDeployment
metadata:
  name: cri-resmgr-extension
type: helm
providerConfig:
  chart: H4sIAAAAAAAAA+1c65PaOBLPZ/4Klee2ancrGGxeV9yXI2SSUJd5FDObXD5NCVuAd2zLK8kQLtn/fVuSbQzM8JgHyWXVVQnGarda3a1ftyQ8E8x8EhNWJZ8FiXlA46rHgiojPJqw2osnoTpQp9VSn0Drn+raaTZcYGq78r7TarrNF6j1NN1vp5QLzBB6wSgV2/h2tf+f0mSr//tTzIS9wFH4mD6kg9vN5n3+B9c74H+31XHqjY7jgv87jVbjBao/1SC30d/c/yeoT5MFCyZTgdy666JBLEgIN1lCGRYQDzbqhSEaSg6OhoQTNiO+XTmpnKD3gQcxQ3yUxj5hSEwJ6iXYg4+s5SX6QJgMKuTadfSzZLCyJuuXf4GEBU1RhBcopgKlnICIgKNxEBJEPnskESiIkUejJAxw7BE0D8RUdZMJATXQp0wEHQkM3Bj4E/g2LvMhLJTCkqZCJN1abT6f21gpa1M2qYWakdfeD/qn51enVVBYPfJbHBLOESN/pAGDoY4WCCegj4dHoGWI54gyhCeMQJugUt85C0QQT14iTsdijhkBKX7ABQtGqVgxVq4djLnMAObCMbJ6V2hwZaFXvavB1UuQ8XFw/e7it2v0sTcc9s6vB6dX6GKI+hfnrwfXg4tz+PYG9c4/of8Mzl+/RARMBd2QzwmT+oOSgTSjch26ImRFgTHVCvGEeME48GBc8STFE4ImdEZYDMNBCWFRwKUzOajng5QwiAKhYoRvDsquVHASZO7voplTiXFEumiJLkvIqfiEw/1EKNYeekfCCHkSe7RJYYpCCGZP0pR5hFcjHIN+YHqOCjmS+20GaChh9HfiiUpFLBLoN3Oa7KIyy7Wq2w64GZoKPS3Hdtp23ap864l5JNqO/4JAzGAB0+IxfRye/ztN1zX5/xi0r/8TFlDAtYUXYs4PrAh25v9WW+X/Vr1TbzvOi7rbcN2Wyf/HIJP/Tf4/Rv7nYGg/DUGQfftPbge0BhXBbRD7XXSZQUtfQkslIgL7WOBuBSFdMWyFqMoMhykwOUUqqUxCOsLhazLGaSi6aIxDTlYrDCvvEik4K4Zf1A5FT+V6xf4Ri4J98V9Oe3As9jyaxgcuCXev/9wl/tfbEv8bsCQ0+H8EMvhv8P9I6z+N9lcaSHoaSA6Ge83FwXHA+uULsockJBi6O89voz//BK4Qj0jIpVQk/WXfpiMYBwEok7lnn56+9cw8Du2L/2yEvYduBO7A/2a70Vrif6sD+O+4TYP/RyGD/wb/nwv/q9XqSg5QGIJTMYXa+386ttbXAv0Q5iNhQxqSO1JDgVHcznHL9kKa+t1dSePx6eDuJ9XeZHxXLpJpiKUQO91KFR4M3jKaJkoD+TXhcFFsZuq7PklCuohILMqNKq9pBtl1FUSpKSg1gv9HWduECPUZQhypizkW3lRdJerqQUrs7mBD7L0+2uzL085+YEfYz8KRkYmcPOWA2uwrSmWkxpM5GU0pvfVoPA4mqX5oPwXkVZpAQBKtPCP55T0GPsASfswZ8SjzH2iLQtzOnvS2uV/cXe3P+tXaFG5Zm2KKIuz5o2TJuva1BlNPpPs7L1l3414j1ZES4UR3zwk4XmSqzDanyZ0W9Ci4Noi3R6iCjjVpWZA9DkhfwQ2I/B8BT2E0QzKW3eYW3mIM4NpMKo8dOk9H8lRJofqdC5qnXMYcof7bt/6/mZIQKgBui+TgJcCu/Z+WK+v/htOqt92O5HOdTqtt6v9jkCxxzQrArACeZQVwUvnypYqgphwHMfg9iECehapqg0a2BGM0xfySQftnZPEpdlvtroXsD3JPHyBc8tsCT1DxRMKCWIyR9RP/9098nZORhPJAULbYJgLyFrlLYPfBAmNffildfutJfQDti/9FGVTVV4ecAe/E/45TnP87bl3u/3fqTYP/xyCD/wb/nxn/AeVz9MywQ2LknYcDfdV+hpNDzwVyVDri+UCunRzi+vi+QiB8AnyEC7AcCIGp9X3miMPxX2XAGayBKKvK0JDBTrZmg134L/f8V+v/dhvSgMH/I5DBf4P/x8N/hR0fFHZc5NDxDMngToj6BqlB6cFvVlGyi75WZO/bTPIVZVmj+dxZY1/8X54LHH4KvOv8123r+t9xnLrbbAD+u822Of89Chn0N+h/jN//yNPG5enE6wJNvuMfAEljdNU5zSyQbe/ARZQt3stRd1FdtahA4FqRDNCzm315GqBV4aChxHetTCSPod6XtHv4CUoOz5ngkiWV1BhmlXZPfqvYdtuVkHN2mB7eLU+j2gMSrrJKEHth6hP0s9poQ/+wrzOd7VfgtEsM89naa3Fh/YJsyIt6kxA0KmtZSpD6Rrhi3sccUeVBICkp/1D5fE8B0v3lA6L9nwOrSESDGZQrUN1zhmhStlxxQr4Da5eNp+5dpmF4SSFuFyuxrHc7k6JxJTRoFAEOLI1cRdujpGAk8az8lB7T6X+vAXcBx24A0d4M3p71Lm/Oe2enV5e9/mnBjZD6vfcbRqNu6SaCnEFCPzsb3Lgvw6xbzA+7AJB9y9N1XQdnvbenH0771xfDm4sPp8OPw8H1ho5dVFOvsJXqv9qdBWHx4IyGaUTOZJTwTQPdV9TmFMnn9Eg3Oy7xMYL9izgERwuW5gJ01xuBtr1PLy/Qy0Z/TH2ek69/u39GfRDVdOvf4b7Jj0Lb6/+ZnhePfAF8R/3fcN32+vt/bcc19f8xyNT/pv5/rvq/XAl3kVOpnJycoGvpYTlgjfE6VyoFlq9xq/wgrTmC/wmXNlGel4uH6gjLiEsYnQU+XITUw6FuLl7fwiPQGjl2qyWdCJ0OxirS5jhWb5QXOQcF4iVK1Pohl6gV4pKtDwUYo2FI2HK9krMxvTtlZwhZ0cWWXhNkZ8ZdrduUctFt1evOzupI4Ak8I7db5M+IklJJ1gvneMG1Ac8vrk+7YMZC08IU4G+IdPhHIb0rk/qQZUOaSMVrUqzyYwpTGyJdvjkPYUY+Y4gLOZNA9uuyU3h2cO+rSagqCntCEcyZW+kemAgkGhFf/rYsa87qG5UvlCJqwutfuakZyVIxtXRXl9rqPtVzP5blpLSvAHsBbqR62pW99jtANYhYIGsq/z5AvvhBtqXcT1OxDCEZ5HdVc3LzTcKAVrSrrveqqqvZXyHQf0BAI0nZXydZbfUw529K308pGEQsnl6bXGx2nKXNNAb9RuD73IQQoTo6s28I9TwRzEBnK2e1VJOfv4m587mM80d8z/J7pX3qvxsZU48oAnfVf431+s+tt1um/jsKmfrP1H+m/jP13w9X/91X/S1rvwdVfuuV1tNVfYfVfE+qhxZZVHurtV65Yru3zlup8rY8UVR4SManR3Z1IHkkc0x98obSHewZl6kfDRkyZMiQIUOGDBkyZMiQIUOGDBkyZMiQIUOGDBkyZMiQIUOGDBky9HegvwCHQ3H6AHgAAA==

  values:
    ### For development purposes - set it to 0 (if you want to register extension but use local process with "make start").
    # replicaCount: 1            

    ### Uncomment this is you want to overwrite extension image or internal installation and agent images.
    ### Remember to build and push image  "make REGISTRY=v2.isvimgreg.com TAG=mybranch build-images push-images"
    ### "image" overwrites extension (for seed) and "images" overwrite installation/agent (for shoot) images defined in charts/images.yaml
    #image:
    #  repository: v2.isvimgreg.com/gardener-extension-cri-resmgr
    #  tag: mybranch
    #  pullPolicy: Always
    #imageVectorOverwrite: |
    #  images:
    #  - name: gardener-extension-cri-resmgr-installation
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-installation
    #  - name: gardener-extension-cri-resmgr-agent
    #    tag: mybranch
    #    repository: v2.isvimgreg.com/gardener-extension-cri-resmgr-agent
    ### Uncomment to provide own "fallback" configuration for CRI-Resource-Manager
    ### Use ballons policy as an example:
    # based on: https://github.com/intel/cri-resource-manager/blob/master/sample-configs/balloons-policy.cfg
    configs:
      ### Those options are passed directly to cri-resmgr binary.
      EXTRA_OPTIONS: | 
        EXTRA_OPTIONS="--metrics-interval 10s" 
      ### This is *static* initial configuraiton file that will be passed do systemd unit
      fallback: |
        policy:
          Active: balloons
        logger:
          Debug: resource-manager,cache,policy,resource-control,config-server
          Klog:
            # Enables nice logs with logger names that can be used in Debug
            skip_headers: true
      ### This is *dynamic* config that will be applied by cri-resmgr-agent
      default: |
        policy:
          Active: balloons
          AvailableResources:
            CPU: cpuset:1-15
          ReservedResources:
            CPU: cpuset:15
          balloons:
            BalloonTypes:
              - Name: "smallBalloon"
                MinCPUs: 2
                MaxCPUs: 2
                MinBalloons: 1
        instrumentation:
          HTTPEndpoint: :8891
          PrometheusExport: true
        # For furhter debugging
        # dump:
        #   Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*
    ### Example of how to use default
    #   fallback: |
    #     ### This is default policy from CRI-resource-manage fallback.cfg.sample
    #     policy:
    #       Active: topology-aware
    #       ReservedResources:
    #         CPU: 750m
    #     logger:
    #       Debug: resource-manager,cache,policy,resource-control
    #       Klog:
    #         # Enables nice logs with logger names that can be used in Debug
    #         skip_headers: true
    #     dump:
    #       Config: off:.*,full:((Create)|(Remove)|(Run)|(Update)|(Start)|(Stop)).*
---
apiVersion: core.gardener.cloud/v1beta1
kind: ControllerRegistration
metadata:
  name: cri-resmgr-extension
spec:
  deployment:
    # For development purpose - deploy the extensions before even shoots are created (or enabled)
    #policy: Always
    deploymentRefs:
    - name: cri-resmgr-extension
  resources:
  - kind: Extension
    type: cri-resmgr-extension
    globallyEnabled: false
    reconcileTimeout: "60s"
